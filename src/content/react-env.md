---
layout: page
title: '[React]追加した環境変数を.envから読み込んだ時にundefinedになるときの対処法'
date: '2020-06-15'
featuredImage: ../images/react.png
---

# あいさつ

今回は React で自宅 PC と外出用 PC で `.env` を使い、開発してた時に undefined と表示され、王道の直し方では解決しなかったので、どうにか読み込めるようにしたので解決方法を記事に仕様と思います。

## 環境

外出用 PC: MacPro
自宅 PC: Windows

## 状況説明

React は `.env` ファイルに `REACT_APP_XXXXXXXXX="YYYYYY"` と書くことで、設定した環境変数を呼びたい場所で `process.env.REACT_APP_XXXXXXXXX` と書くことで書いたところに `YYYYYYY` を入れることが出来るありがたいやつです。

自分は自宅用と外出用で一つのプロジェクトをいじって、env を追加したときはもう片方で pull した後に追加するという感じで開発の方をしてました。

そこで起きた問題が、env で新しく追加した環境変数のみ読みこまない問題でした。

```text:title=.env
/* 前から書いてた(読み込む) */
REACT_APP_HOGE="HOGE"
REACT_APP_FUGA="FUGA"

/* 新しく追加(読みこまない) */
REACT_APP_PIYO="PIYO"
```

新しく追加した `REACT_APP_PIYO` を読みこもうとすると `undefined` になり、こんな事あったけ？？？どうにか読み込めるようにしないとなっていうのが始まりです。

console.log(process.env)で確認してもそもそも認識自体されてないので余計に混乱してました。

## 解決法(これで解決した。)

`.gitignore` の `.env` を一回消してから `yarn start` で読み込みした。

？？？？？

`.gitignore` で github 等に push しないようにするとは思うのですが、なぜ読み込まないのか、色々調べて見たのですが（たぶん調べ方が悪い）理由が見つからず、もしわかる方が要れば Twitter でもいいので連絡もらえたらと思います。

もしかしたら、おま環（お前の環境だけだよ）説もあるかもしれないですね。。。

## 王道の解決法(解決は出来なかった)

一応 `.env` が読み込まない時によくやることも一応書いときます。

### 1. 設定後に再コンパイルしてない

`.env` を書き直したりしたときは、一回 `Ctrl + C` で止めて `yarn start` をもう一回して再コンパイルしましょう

### 2. env の書き方が違う

`.env` は必ず `REACT_APP_` から始めましょう。誤字脱字がないかしっかり確かめましょう。

### 3. .env がプロジェクト直下にない

プロジェクトの直下にしっかり入れましょう。

今回見たいに一部は読み込んでいるとかであれば問題はないかと思います。

## まとめ

どうでしょうか？

自分と同じ状況にあった人いますでしょうか？

なんでこのような現象が起きたのか知りたいので本当に知りたいので、少しでもわかる人が要れば[Twitter](https://twitter.com/uechan9220)教えて頂けると幸いです。

自分でも調べて何かしら見つかれば追加で書いていきます。
